# On the Effectiveness of Unified Debugging: An Extensive Study on 16 Program Repair Systems #
 
This repository contains the dataset and scripts for *On the Effectiveness of Unified Debugging: An Extensive Study on 16 Program Repair Systems* - Automated Software Engineering (ASE'20).

Requirements to run this repository:
 - Python 3
 - R (Package "ggpubr", "ggplot2", "reshape2", "cowplot" are required)

# 1 - Structure #

## 1.1 [Data](Data/) ##

- [ExperimentalData](Data/ExperimentalData/).
Contains the raw experimental dataset of this paper.
The experimental data can be found in ProFL-\[**toolName**]/\[**d4j-project**]/, such as [Data/ExperimentalData/ProFL-PraPR/Lang-1](Data/ExperimentalData/ProFL-PraPR/Lang-1).
In such folders there are two files, generalSusInfo.profl and aggregatedSusInfo.profl.

  * generalSusInfo.profl

    This file represents the spectrum-based fault localization (hereby referred to as SBFL) as generated by the Ochiai formula and fault localization aggregation strategy.
 
    The format for these files are as follows:
 
    ```
    [MethodRank 1] | [Suspiciousness Score 1] | [MethodSignature 1];
    [MethodRank 2] | [Suspiciousness Score 2] | [MethodSignature 2];
    ...
    [MethodRank N] | [Suspiciousness Score N] | [MethodSignature N];
    ```
    These files are sorted by descending Suspiciousness Score. 
    Methods with zero suspiciousness are excluded.
    Methods which tie for the same rank all receive the *worst rank*.
    As an example, if the Top-3 methods tie for the same rank, each method would receive a rank of 3 and the consequent method would be ranked 4.
 
  * aggregatedSusInfo.profl

    This file represents a repair tool's given unified debugging results on a project.

    The format for these files are as follows:
 
    ```
    [MethodRank 1] | [Suspiciousness Score 1] | Patch Category 1 | [MethodSignature 1];
    [MethodRank 2] | [Suspiciousness Score 2] | Patch Category 2 | [MethodSignature 2];
    ...
    [MethodRank N] | [Suspiciousness Score N] | Patch Category N | [MethodSignature N];
    ```

    As these program repair tool attempts to repair projects, numerous repair patches are created.
    Each patch attempt modifies some set of methods, which are then associated to the patch.
    The highest priority patch category is associated for each method, resulting in the above format.

    The possible Patch Categories are (ordered from highest priority to lowest priority):
      - *CleanFix*, representing methods where the best patch only improves faulty functionality without degrading correct functionality
      - *NoisyFix*, representing methods where the best patch improves faulty functionality but also degrades correct functionality
      - *NoneFix*, representing methods where the best patch neither degrades nor improves existing functionality
      - *NegFix*, representing methods where the best patch only degrades correct functionality
      - *Unmodified*, representing methods which receive no patches from the repair tool

- [FaultyMethods](Data/FaultyMethods/).
Contains the ground truth faulty methods per Defects4J 1.0.0 project.
For a given project, each file contains the set of project fault methods.


## 1.2 [Scripts](Scripts/) ##

Following subfolders and file are included in this folder.

- RQ1_1: Contains data and script to generate the table corresponding to Figure 3.

- RQ1_2: Contains the data and script to generate Figure7.

- RQ2: Contains the data and script to generate Figure 8.

- RQ3: Contains the data and script to generate Figure 9.

- RQ4_1: Contains the script to generate the result of UniDebug+ and UniDebug++.

- RQ4_2: Contains the data and script to generate Figure 10.

- RunFinalResult.sh: An All-In-One script to run other scripts. Described in Section 2.

## 1.3 [Results](Results/) ##

The structure of this folder is as follows.
 
 - FinalResults: Final results generated from the [scripts](Scripts/) folder.
 
 - IntermediateResults: Intermidiate results used to generate final results.
 
 - SBFLResults: Ground truth result from spectrum-based fault localization.


# 2 - Recreating Tables \& Figures #

To recreate the paper's tables and figures, run the following command:

```
cd Scripts

bash RunFinalResult.sh $RQ
```
$RQ represents a research question.

\*\**Note See RQ4_1 for specific configurable parameters for RQ4_1. Running RQ4_1 will output UniDebug++ results from Table 5.*

The results will be generated in [Results/FinalResults](Results/FinalResults).

Output for different arguments of $RQ:

- RQ1_1: RQ1_1.csv, corresponding to Figure 3.

- RQ1_2: RQ1_2.pdf, corresponding to Figure 7.

- RQ2: RQ2.pdf, corresponding to Figure 8.

- RQ3: RQ3_*.pdf, corresponding to Figure 9.

- RQ4_1: *.result files, corresponding to the specific combination of tools. Output generated in RQ4_1 instead of Results/FinalResults.

- RQ4_2: RQ4_2.pdf, corresponding to Figure 10.

## Configuring RQ4_1 ##

Table 5's results can be reproduced with the main script [AggreCombinePatch.py](Scripts/RQ4_1/AggreCombinePatch.py), generating the results of UniDebug+ and UniDebug++.

This file can be executed with the following command:

``` python
python AggreCombinePatch.py <Tool Combination File> [CleanFix | NoisyFix | NoneFix | NegFix]
```
After running such a command, a \*.result file will be generated in [Scripts/RQ4_1](Scripts/RQ4_1), describing the metrics for each combination.

The ***Tool Combination File*** is a file containing a line delimited list of attempted project combinations.
A list of available names can be found in [IndividualCombinations.txt](Scripts/RQ4_1/IndividualCombinations.txt).
The supplied Tool Combination File should be located within the [Scripts/RQ4_1/](Scripts/RQ4_1/) directory.

The script's second argument represents which patch category Non-Modify code elements (methods which are unmodified by a repair tool) fall into.

Running the following command will reflect the UniDebug++ results in the ASE'20 paper and generate a ***GreedyTop1.txt.result*** file in [Scripts/RQ4_1/](Scripts/RQ4_1/).

``` python
python AggreCombinePatch.py GreedyTop1.txt NegFix
```
If you wish to obtain UniDebug+ results, instead of UniDebug++, you may provde a third argument as follows:

``` python
python AggreCombinePatch.py GreedyTop1.txt NegFix False
```

Running the following command will exhaustively attempt all combinations of the 16 repair tools and generate a ***ExhaustiveCombinations.txt.result*** file in [Scripts/RQ4_1/](Scripts/RQ4_1/), reflecting the UniDebug++ technique.

``` python
python AggreCombinePatch.py ExhaustiveCombinations.txt NegFix
```

\*\**Note that each successful run of AggreCombinePatch.py ***appends*** data to any existing file. Thus, you may wish to clear or move the results after every run*

# 3 Additional Information #
For additional information, such as tables / figures, view the project wiki.

